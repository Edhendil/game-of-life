!function(){var t=angular.module("gameOfLife",["ui.router","templates"]);t.config(["$locationProvider",function(t){t.html5Mode(!0)}])}(),!function(){function t(t){function e(e){this.size=e,this.pattern=t.makeArray(e,e,null)}return e}t.$inject=["arrayUtils"],angular.module("gameOfLife").factory("Brush",t)}(),!function(){function t(t){function e(t,e,a){this.lifeData=t,this.width=e,this.height=a}return e.build=function(a,n){var r=t.makeArray(a+2,n+2,!1);return new e(r,a,n)},e.prototype.updateLife=function(t){var a,n,r=e.build(this.width,this.height);for(a=0;a<this.width;a++)for(n=0;n<this.height;n++){var i,u=this.countNeighbours(a,n);i=this.getField(a,n)?t.survive[u]:t.create[u],r.setField(a,n,i)}return r},e.prototype.getField=function(t,e){return this.lifeData[t+1][e+1]},e.prototype.setField=function(t,e,a){this.lifeData[t+1][e+1]=a},e.prototype.countNeighbours=function(t,e){var a=0;return t++,e++,this.lifeData[t-1][e]&&a++,this.lifeData[t+1][e]&&a++,this.lifeData[t][e-1]&&a++,this.lifeData[t-1][e-1]&&a++,this.lifeData[t+1][e-1]&&a++,this.lifeData[t][e+1]&&a++,this.lifeData[t-1][e+1]&&a++,this.lifeData[t+1][e+1]&&a++,a},e.prototype.countLive=function(){var t,e,a=0;for(t=0;t<this.width;t++)for(e=0;e<this.height;e++)this.getField(t,e)&&a++;return a},e.prototype.countDead=function(){return this.count()-this.countLive()},e.prototype.count=function(){return this.width*this.height},e}t.$inject=["arrayUtils"],angular.module("gameOfLife").factory("LifeState",t)}(),!function(){function t(t){function e(t,e){this.survive=t,this.create=e}return e.empty=function(){return new e(t.makeArray1(10,!1),t.makeArray1(10,!1))},e.parseText=function(t){var a,n=e.empty(),r=n.survive;for(a=0;a<t.length;a++){var i=t.charAt(a);if("/"===i)r=n.create;else{var u=parseInt(i);r[u]=!0}}return n},e}t.$inject=["arrayUtils"],angular.module("gameOfLife").factory("RuleSet",t)}(),!function(){function t(){return{makeArray:function(t,e,a){var n,r,i=[];for(n=0;t>n;n++)for(i[n]=[],r=0;e>r;r++)i[n][r]=a;return i},makeArray1:function(t,e){var a,n=[];for(a=0;t>a;a++)n[a]=e;return n}}}angular.module("gameOfLife").factory("arrayUtils",t)}(),!function(){function t(t,e){return{square:function(){var e=new t(11);return e.pattern[5][5]=!0,e},eraser:function(){var e=new t(11);return e.pattern[5][5]=!1,e},cross:function(){var e=new t(11);return e.pattern[5][4]=!0,e.pattern[4][5]=!0,e.pattern[5][5]=!0,e.pattern[6][5]=!0,e.pattern[5][6]=!0,e},missile:function(){var e=new t(11);return e.pattern[6][6]=!0,e.pattern[6][5]=!0,e.pattern[6][4]=!0,e.pattern[5][4]=!0,e.pattern[4][5]=!0,e},custom:function(){return new t(11)}}}t.$inject=["Brush","arrayUtils"],angular.module("gameOfLife").factory("brushFactory",t)}(),!function(){function t(){function t(t,e,a){var n=4*(a*t.width+e);t.data[n]=0,t.data[n+1]=0,t.data[n+2]=0,t.data[n+3]=255}function e(t,e,a){var n=4*(a*t.width+e);t.data[n]=255,t.data[n+1]=255,t.data[n+2]=255,t.data[n+3]=255}var a,n,r,i,u="lifeStage";return{init:function(t,e){a=document.getElementById(u),a.width=t,a.height=e,n=a.getContext("2d"),n.imageSmoothingEnabled=!1},resize:function(t,e){a.width=t,a.height=e},updateCanvas:function(u){r=$("<canvas>").attr("width",u.width).attr("height",u.height)[0],i=r.getContext("2d");var o,l,c=i.createImageData(u.width,u.height);for(o=0;o<u.width;o++)for(l=0;l<u.height;l++)u.getField(o,l)?t(c,o,l):e(c,o,l);i.putImageData(c,0,0),n.scale(a.width/u.width,a.height/u.height),n.drawImage(r,0,0),n.setTransform(1,0,0,1,0,0)},getMousePos:function(t){var e=a.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}}}angular.module("gameOfLife").factory("canvasService",t)}(),!function(){function t(){var t,e=30;return{reset:function(){t=[];var e=(new Date).getTime();t.push(e)},next:function(){var a=(new Date).getTime();return t.push(a),t.length>e&&t.shift(),Math.floor(1/((a-t[0])/1e3)*t.length)}}}angular.module("gameOfLife").factory("frameRateService",t)}(),!function(){function t(t,e,a,n,r,i,u){function o(){b=a.createEmptyState(w,S),n.init(p,y),n.updateCanvas(b),l("conway"),v.brush=v.availableBrushes.custom()}function l(t){var e=v.availableRules[t],a=r.parseText(e);v.selectedRules=a}function c(t){var e=Math.floor(parseInt(t.x)*(w/p)),a=Math.floor(parseInt(t.y)*(S/y));g(b,e,a,v.brush),n.updateCanvas(b)}function s(t){i.reset(),v.gameRunning=!0,m=e(h,1e3/t)}function f(){angular.isDefined(m)&&(v.gameRunning=!1,e.cancel(m),m=void 0),v.realFps=0}function h(){d(b.updateLife(v.selectedRules)),v.realFps=i.next()}function d(t){b=t,n.updateCanvas(t)}function g(t,e,a,n){var r,i,u=n.size*v.brushScale,o=e-Math.floor(u/2),l=a-Math.floor(u/2);for(r=0;u>r;r++)for(i=0;u>i;i++){var c=Math.floor(r/v.brushScale),s=Math.floor(i/v.brushScale),f=o+r,h=l+i;f>-1&&f<t.width&&h>-1&&h<t.height&&null!=n.pattern[c][s]&&t.setField(f,h,n.pattern[c][s])}}var m,v=this,p=512,y=512,w=256,S=256;v.selectedRules=null,v.tickerButtonText="Start",v.fps=25,v.realFps=0,v.brush=null,v.brushScale=1,v.gameRunning=!1,v.availableStates={empty:a.createEmptyState,line:a.createLineState,random:a.createRandomState},v.availableRules={conway:"23/3",seed:"/2",ameba:"1358/357",daynight:"34678/3678",longlife:"5/345",coral:"45678/3",34:"34/34",diameba:"5678/35678",highlife:"23/36",replicator:"1357/1357",labirynth:"12345/3",cancer:"1/1",petals:"012345678/3",wolfram:"018/018",traycloth:"/234",coagulation:"235678/378",pseudolife:"238/357"},v.availableBrushes={eraser:u.eraser,square:u.square,cross:u.cross,missile:u.missile,custom:u.custom},v.selectedRuleSet="conway",v.selectedBrush="custom",v.selectedState="empty";var b=null;o(),v.handleFpsChange=function(){void 0!==m&&(f(),s(v.fps))},v.loadRulePreset=function(){var t=v.availableRules[v.selectedRuleSet];v.selectedRules=r.parseText(t)},v.handleSetStateButton=function(){var t=v.availableStates[v.selectedState];d(t(w,S))},v.handleTickerButton=function(){void 0!==m?(f(),v.tickerButtonText="Start"):(s(v.fps),v.tickerButtonText="Stop")},v.handleCanvasClick=function(t){var e=n.getMousePos(t);c(e)},v.handleCanvasMove=function(t){if(1===t.which){var e=n.getMousePos(t);c(e)}},v.performStep=function(){b=b.updateLife(v.selectedRules),n.updateCanvas(b)},v.changeBrush=function(t,e,a){t.ctrlKey?v.brush.pattern[e][a]=null:3===t.which?v.brush.pattern[e][a]=!1:v.brush.pattern[e][a]=!0},v.brushMoveChange=function(t,e,a){1!==t.which&&3!==t.which||v.changeBrush(t,e,a)},v.loadBrush=function(){v.brush=v.availableBrushes[v.selectedBrush]()}}t.$inject=["$scope","$interval","gameStateFactory","canvasService","RuleSet","frameRateService","brushFactory"],angular.module("gameOfLife").controller("GameController",t)}(),!function(){angular.module("gameOfLife").config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/"),t.state("game",{url:"/",templateUrl:"game/game.html",controller:"GameController as gameController"})}])}(),!function(){function t(t,e){return{createEmptyState:function(a,n){return new t(e.makeArray(a+2,n+2,!1),a,n)},createLineState:function(a,n){var r,i=e.makeArray(a+2,n+2,!1);for(r=1;a+1>r;r++)i[r][r]=!0;return new t(i,a,n)},createRandomState:function(e,a){var n,r,i=t.build(e,a);for(n=0;e>n;n++)for(r=0;a>r;r++)i.setField(n,r,Math.random()<.5);return i}}}t.$inject=["LifeState","arrayUtils"],angular.module("gameOfLife").factory("gameStateFactory",t)}(),!function(){function t(){return function(t){for(var e=[],a=0;t>a;a++)e.push(a);return e}}angular.module("gameOfLife").filter("range",t)}();
//# sourceMappingURL=gameOfLife.min.js.map
